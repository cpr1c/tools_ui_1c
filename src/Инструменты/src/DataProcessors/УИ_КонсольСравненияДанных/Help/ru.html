<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html;charset=utf-8" http-equiv="content-type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 8.00.7601.17514"></meta></head><body>
<p align="left"><strong><font size="3">Консоль сравнения данных 15.4.55</font></strong></p>
<p><font size="1"><strong><font size="2">Описание:</font><br></strong>      Обработка  предназначена для сравнения данных, полученных из разных источников: информационных баз 1С 8, </font><span style="font-size: x-small;">информационных баз</span><span style="font-size: x-small;"> 7.7, </span><span style="font-size: x-small;">баз данных SQL, файлов формата CSV/TXT/DBF/XLS/DOC/XML, вручную заполненного табличного документа.</span></p>
<p><font size="1"><strong><font size="2">Инструкция по использованию:</font></strong><br></font></p>
<p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">      Сравнение можно производить между данными следующих источников: текущей/внешними базами 1С 8, внешними базы данных SQL, файлов формата CSV/TXT/DBF/XLS/XML, вручную заполненного табличного документа. В каждом сравнении участвуют выборки из двух источников, причем для каждого источника, являющегося базой данных должен быть написан запрос на языке 1С (для информационной базы 1С 8) либо SQL (для базы данных SQL), а для файла должны быть заданы соответствия реквизитов выборки колонкам файла. После этого даные извлекаются из источников, а полученные таблицы значений сравниваются между собой по первичному ключу, который определяется как первая колонка запроса.  В верхней части формы находятся кнопки с изображениям кругов Эйлера, предназначенные для указания обработке, какую операцию реляционной алгебры применять для объединения результатов запросов. Выбранная операция подсветится зеленым цветом.<br style="BOX-SIZING: border-box">      Параметры, устанавливаемые для каждой базы данных, заполняются на вкладках, соответствующих баз:</font></p>
<ul style="box-sizing: border-box; widows: 2; text-transform: none; background-color: rgb(255, 255, 255); font-style: normal; margin-top: 0px; text-indent: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; white-space: normal; orphans: 2; margin-bottom: 10px; letter-spacing: normal; color: rgb(51, 51, 51); font-size: 14px; word-spacing: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px;"><li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font size="1"><strong>Тип базы</strong> – реквизит может принимать следующие значения:</font> 
<ul style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px"><li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><span style="BOX-SIZING: border-box; FONT-FAMILY: Cambria"><font size="1" face="Verdana"><strong>текущая база 1С 8</strong> – в этом случае никаких дополнительных параметров подключения к базе данных заполнять не нужно;</font></span> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>внешняя база 1С 8</strong> – внешняя база 1 С8, доступная из текущей подсети, в этом случае необходимо заполнить параметры Версия платформы, Вариант работы, Путь к базе или Сервер/Имя базы, Логин и Пароль;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>база данных SQL</strong> – база данных SQL;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font size="1"><strong>файл</strong>  – файл выбранного формата;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font size="1"><strong>таблица</strong> – таблица в табличном документе на форме.</font> </li></ul></li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Вариант работы</strong> – вариант работы информационной базы, может принимать следующие значения:</font> 
<ul style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px"><li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>файловый</strong> – внешняя база размещена в файле, в этом случае необходимо заполнить Путь к базе, Логин и Пароль;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>клиент-серверный</strong> – внешняя база размещена на сервере приложений 1С, в этом случае необходимо заполнить Сервер, Имя базы, Логин и Пароль;</font></li></ul></li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Версия платформы</strong> – версия платформы 1С 8, отвечает за выбор COM-компоненты, используемой для подключения к базе;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Путь к базе</strong> – путь к файловой базе;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font size="1"><strong>Драйвер</strong> – имя драйвера для подключения к базе данных SQL, можно выбрать из списка предопределенных (SQL Server, PostgreSQL);</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Сервер</strong> – имя сервера приложений 1С или сервера баз данных;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Имя базы</strong> – имя базы на сервере приложений 1С или базы данных SQL;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Логин</strong> – логин пользователя внешней базы 1С (у пользователя должно быть право внешнего соединения) или пользователя базы данных SQL;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Пароль</strong> – пароль пользователя внешней базы 1С 8 или пользователя базы данных SQL;</font> 
</li>
<li align="justify" style="font-weight: normal; margin-bottom: 0px; box-sizing: border-box; margin-top: 0px;"><font size="1" style="box-sizing: border-box;"><strong>Файл находится на</strong> – размещение файла - на клиентском ПК или на сервере;</font></li>
<li align="justify" style="margin-bottom: 0px; box-sizing: border-box; margin-top: 0px;"><font size="1" style="box-sizing: border-box;"><b>Номер книги/таблицы </b>– номер книги Excel или таблицы Word при чтении из файлов формата XLS/DOC.</font></li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Формат</strong> – формат файла: CSV, TXT, DBF, XLS, DOC или XML;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Путь к файлу</strong> – путь к файлу указанного формата;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>№ 1-й строки</strong> – строка файла или таюлицы, с которой необходимо начать загрузку данных (нумерация начинается с 1);</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Способ хранения данных</strong> – способ хранения данных в XML-файле, возможные значение: <em>В элементах, В атрибутах</em>;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Имя родитеского узла </strong>– имя узла XML-файла, в котором содержится коллекция элементов с данными;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font size="1"><strong>Имя элемента с данными </strong>– имя элемента XML-файла, в котором содержатся данные (собственно, имя элемента колекции);</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>№ столбца источника </strong>– номер колонки, содержащей столбец  ключа (нумерация начинается с 1);</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font size="1"><strong>имя столбца источника </strong>– имя колонки, содержащей столбец  ключа;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Строка()</strong> – значение столбца ключа будет приведено к строковому типу;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>длина</strong>  – если установлен флаг Приводить к строке, значение ключа будет приведено к строковому типу указанной длины (требуется только для баз 1С 8);<font size="3"> </font></font>
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"></font><font style="BOX-SIZING: border-box" size="1"><strong>Удалять символы { }</strong> – символы { и } будет заменены в столбце ключа на пустые строки;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>ВРег()</strong> – символы нижнего регистра, входящие в столбец ключа, будут преобразованы в символы верхнего регистра;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Использовать УИД</strong> – столбец ключа будет сформирован путем вызова функции УникальныйИдентификатор() из первой колонки, которая должна быть ссылочного типа;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Выполнять произвольный код</strong> – при установленном флаге произвольный код, находящийся в ниже расположеном поле, будет выполняться при чтении каждой строки источника (пример произвольного кода: <em>КлючТек = Сред(КлючТек, 2, 9)</em>;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Текст запроса</strong> – текст запроса на языке 1С для баз 1С 8 (доступен конструктор запроса) и на языке SQL для баз данных SQL;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font size="1"><strong>Сворачивать данные по ключу </strong>– сворачивать данные, полученные из источника, по ключу, для реквизитов применяется агрегатная функция <em>Сумма</em>;</font> </li></ul><p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">       Таблица <strong>Заполнение и обработка реквизитов получателя </strong>предназначена для задания соответствия колонок источников данных реквизитам выборки или произвольного кода:</font></p>
<ul><li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font size="1"><strong>Реквизит А/Б</strong> – номер реквизита соответствующего источника данных;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font size="1"><strong>Номер колонки</strong> – номер колонки CSV/TXT/DBF/XLS файла;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font size="1"><strong>Имя колонки</strong> – имя колонки XML-файла;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font size="1"><strong>Произвольный код</strong> – произвольный код для заполнения текущего реквизита (обращение к значениям реквизитов осуществляется по именам <strong>Р1...Р5</strong>, обращение к текущему - по имени <strong>РТек</strong>, пример для реквизита 3: <em>РТек = Р1 * Р2 * 1.2</em>).</font></li></ul><p style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"> </p>
<p style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">       На вкладке <strong>Общие настройки</strong> находятся настройки, относящиеся к обоим источникам данных:</font> </p>
<ul><li><font style="BOX-SIZING: border-box" size="1"><font style="BOX-SIZING: border-box" size="1"><strong>Число столбцов в ключе</strong> – при значении, равном единице, ключ простой, иначе составной, причем столбцы ключа определяются на основании первых колонок каждой выборки для баз 1С и SQL, а для файлов необходимо явно указать номер колонки, соответствующей каждому столбцу ключа;</font> </font>
</li>
<li><font style="BOX-SIZING: border-box" size="1"><font style="BOX-SIZING: border-box" size="1"><strong>Число строк с пустыми ключами для прерывания чтения</strong> – при чтении данных из источника подсчитываются идущие подряд строки с пустми ключами, при достижении указанного количества чтение прерывается</font>;</font></li>
<li><font size="1" style="box-sizing: border-box;"><font size="1" style="box-sizing: border-box;"><b>Путь к файлу выгрузки (на сервере)</b> – путь к файлу на сервере, в который будет выгружена таблица значений, содержащая расхождения</font>;</font></li>
<li><font size="1" style="box-sizing: border-box;"><font size="1" style="box-sizing: border-box;"><b>Формат файла выгрузки</b> – формат файла, в который будет выгружена таблица значений, содержащая расхождения (поддерживаются форматы CSV, DOCX, HTML, MXL, ODS, PDF, TXT, XLS, XLSX).</font></font></li></ul><p><font size="1">       Реквизит <strong>Пользовательский режим</strong> устанавливается программно – если флаг установлен в Истина, то при открытии формы все реквизиты настроек скрываются, остаются видимыми только команда сравнения, команды открытия сохраненных настроек.</font></p>
<p><font style="BOX-SIZING: border-box" size="1">      Для обеспечения возможности сравнения данных по периодам можно использовать предопределенные параметры <strong>ДатаНачала</strong> и <strong>ДатаОкончания</strong>, которые можно задать на вкладке <strong>Основные</strong> как в виде абсолютного значения периода, так и в виде относительного значения с указанием дискретности (год, месяц, день). Относительный период удобен тем, что при ежедневном использовании обработки для контроля данных период будет пересчитываться каждый раз при загрузке настроек.</font></p>
<p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">      При выводе каждой строки (т.е. уже после объединения выборок) производится проверка условий вывода и условий запрета вывода, расположенных в табличной части, и если не выполняется условие вывода или выполняется условие запрета вывода, то строка удаляется из таблицы значений. Данный механизм игнорируется только для строк, в которых в одной из баз найдено больше одной строки для данного первичного ключа, т.к. в этом случае сравнение бессмысленно. Параметры, отвечающие за вывод и запрет вывода строк, заполняются на вкладках <strong>Условия вывода строк</strong> и <strong>Условия запрета вывода строк.</strong> Здесь можно заполнить следующие реквизиты:</font></p>
<ul style="box-sizing: border-box; widows: 2; text-transform: none; background-color: rgb(255, 255, 255); font-style: normal; margin-top: 0px; text-indent: 0px; font-family: Verdana, Arial, Helvetica, sans-serif; white-space: normal; orphans: 2; margin-bottom: 10px; letter-spacing: normal; color: rgb(51, 51, 51); font-size: 14px; word-spacing: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px;"><li style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font size="1"><b>Отключены </b>– условия не будут учитываться при сравнении данных;</font> 
</li>
<li align="justify" style="font-weight: normal; margin-bottom: 0px; box-sizing: border-box; margin-top: 0px;"><font size="1"><strong>Логический оператор для объединения условий</strong> – оператор объединяет все строки из табличной части;</font></li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Код редактируется вручную</strong> – при установке флага код становится доступным для редактирования;</font> 
</li>
<li style="font-weight: normal; box-sizing: border-box; margin-top: 0px; margin-bottom: 0px;" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Многострочное поле ввода без имени</strong> – произвольный код, формируемый автоматически на основании строк табличной части, может редактироваться вручную, выполняется для каждой строки таблицы значений Результат сравнения.</font></li></ul><p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">      Реквизиты табличных частей заполняются следующим образом:</font></p>
<ul style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; MARGIN-TOP: 0px; TEXT-INDENT: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; MARGIN-BOTTOM: 10px; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px"><li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font size="1"><strong>Реквизит</strong> – имя реквизита таблицы значений Результат сравнения;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Условие</strong> – условие сравнения;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>С чем сравнивать</strong> – определяется режим сравнения, может принимать значения Реквизит и Значение;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Значение</strong> – заполняется в случае, если реквизит С чем сравнивать равен Значение, в данном режиме значение реквизита таблицы значений сравнивается с указанным в данном поле значением;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Реквизит</strong> – заполняется в случае, если реквизит С чем сравнивать равен Реквизит, в данном режиме значение реквизита таблицы значений сравнивается со значением реквизита, указанного в данном поле.</font></li></ul><p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">      В результате выполнения произвольного кода с вкладки <strong>Условия вывода строк</strong> устанавливается значение переменной УсловияВыводаСтрокиВыполнены, а с вкладки <strong>Условия запрета вывода строк</strong> - значение переменной УсловияЗапретаВыводаСтрокиВыполнены. Строка останется в таблице значений Результат сравнения, если УсловияВыводаСтрокиВыполнены = Истина, а УсловияЗапретаВыводаСтрокиВыполнены = Ложь. Необходимо также помнить, что если по первичному ключу хотя бы в одной из баз найдено более одной строки, то условия игнорируются, т.к. такие сроки должны быть отображены для выявления причин ошибки.</font></p>
<p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">      После настройки всех параметров необходимо нажать кнопку кнопку <strong>Сравнить данные</strong>, обработка выполнит оба запроса, объединит их в соответствии с выбранной операцией реляционной алгебры, выведет в таблицу значений, затем отфильтрует в соответствии с условиями вывода и запрета вывода строк, после чего отобразит ее на форме на вкладке <strong>Результат сравнения</strong>, которая содержит следующие колонки:</font></p>
<ul style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; MARGIN-TOP: 0px; TEXT-INDENT: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; MARGIN-BOTTOM: 10px; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px"><li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font size="1"><strong>Ключ</strong> – ключ</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Число записей А</strong> - количество записей, найденных в источнике данных А по ключу;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Число записей Б</strong> - количество записей, найденных в источнике данных Б по ключу;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Реквизит А1...А5</strong> – реквизиты выборки из источника А;</font> 
</li>
<li style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1"><strong>Реквизит Б1...Б5</strong> – реквизиты выборки из источника Б.</font></li></ul><p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">      В случае, если число строк с данным первичным ключом в базе X больше одной, то в колонке X, хранящей количество строк, найденных по данному первичному ключу, выводится число найденных строк, а реквизиты заполняются данными из первой попавшейся строки внешней БД (для облегчения последующего поиска ошибки), и подсвечиваются розовым цветом. Такие строки должны отсутствовать, если первичный ключ выбран правильно.</font></p>
<ul style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; MARGIN-TOP: 0px; TEXT-INDENT: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; MARGIN-BOTTOM: 10px; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px"><font size="1"></font></ul><p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">      При подключениях к информационным базам 1С 8 доступен конструктор запросов (команда Конструктор запросов расположена на вкладках, соответствующих настройкам баз 1С 8).</font></p>
<p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font style="BOX-SIZING: border-box" size="1">      Для обеспечения возможности хранения настроек сравнения в базе необходимо добавить в конфигурацию справочник <strong>ВС_ОперацииСравненияДанных</strong> с реквизитом <strong>Операция</strong> типа ХранилищеЗначения</font><font size="1"><font size="2"><font size="1">.</font></font></font></p>
<p style="BOX-SIZING: border-box; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); FONT-STYLE: normal; TEXT-INDENT: 0px; MARGIN: 0px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; LETTER-SPACING: normal; COLOR: rgb(51,51,51); FONT-SIZE: 14px; FONT-WEIGHT: normal; WORD-SPACING: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px" align="justify"><font size="1"><font size="2"><font size="1"></font></font></font> </p>
<p><font size="2"><strong>История версий:</strong><br></font></p><font size="1"></font>
<p class="Usual"><font size="1">Версия 15.4.55<br>реализована возможность указания заголовков реквизитов таблицы расхождений для пользователя (кроме 1С 7.7).</font></p>
<p class="Usual"><font size="1">Версия 15.3.54:<br>реализована возможность сохранения/загрузки табличных документов в файл/из файла настроек или в элемент/из элемента справочника <b>ВС_ОперацииСравненияДанных</b> для источников данных типа <i>Таблица</i></font><span style="font-size: x-small;">;</span></p><font size="1">доработан интерфейс для более компактного размещения кнопок сохранения/загрузки настроек.</font>
<p class="Usual"><font size="1">Версия 15.2.53:<br>доработан механизм расчета оптимальной ширины полей при выгрузке результата сравнения в файл.</font></p>
<p class="Usual"><font size="1">Версия 15.2.52:<br>исправлена ошибка, из-за которой числовые значения в столбцах ключа округлялись до целого при сравнении.</font></p>
<p class="Usual"><font size="1">Версия 15.2.51:<br>добавлена возможность предварительно просмотра данных для каждого источника данных в режимах <i>Все строки</i>, <i>100 строк</i>, <i>1000 строк</i>, <i>Дубликаты</i>;<br>в строках с ключами, для которых обнаружены дубликаты, значения реквизитов больше не выводятся в таблице расхождений (для детального просмотра строк-дубликатов предназначена форма предварительного просмотра в режиме <i>Дубликаты)</i>.</font></p>
<p class="Usual"><font size="1">Версия 15.1.50:<br>исправлена ошибка, возникавшая при сравнении по составному ключу в последней версии обработки.</font></p>
<p class="Usual"><font size="1">Версия 15.1.49:<br>реализована возможность выгрузки файла расхождений в форматах CSV, DOCX, HTML, MXL, ODS, PDF, TXT, XLS, XLSX.</font></p>
<p class="Usual"><font size="1">Версия 15.0.48:<br>добавлено индексирование сравниваемых таблиц значений.</font></p>
<p class="Usual"><font size="1">Версия 15.0.47:<br>исправлена ошибка, из-за которой не обновлялись связанные элементы справочника <b>Операции сравнения данных</b>.</font></p>
<p class="Usual"><font size="1">Версия 15.0.46:<br>реализована возможность получения данных из строки JSON;<br>после открытиия операции из справочника или файла таблица расхождений очищается;<br><font size="1">доработан интерфейс.</font></font></p>
<p class="Usual"><font size="1">Версия 14.1.45:<br>реализована возможность отключения условий вывода и запрета вывода строк без удаления строк табличной части;<br>расширен список возможных значений версии платформы 1С 8 (используется для получения ProgID COM-объекта при подключении к внешней базе);<br></font><span style="font-size: x-small;">реализован вывод предупреждения, </span><span style="font-size: x-small;">если число колонок в </span><span style="font-size: x-small;">файле XLS </span><span style="font-size: x-small;">меньше указанного в настройках для ключа или реквизитов</span><span style="font-size: x-small;">;<br>реализован вывод предупреждения, если число колонок в выборке 1С 8 / SQL меньше указанного числа столбцов в ключе;<br>исправлена ошибка, из-за которой при ключе из трех столбцов и некоторых вариантах обработки ключа колонки могли расположиться в некорректной последовательности.</span></p>
<p class="Usual"><font size="1">Версия 14.0.44:<br>реализовано получение данных из файлов формата DOC (Microsoft Word);<br>реализована возможность указания конкретного номера книги при получении данных из файла формата XLS;<br>реализована возможность загрузки файлов с клиентского ПК (тем не менее, необходимое для чтения ПО должно быть установлено на сервере, например, <i>Microsoft Office,</i> </font><span style="font-size: x-small;">т.к. обработка файлов производится на сервере</span><span style="font-size: x-small;">)</span><span style="font-size: x-small;">.</span></p><font size="1"><font size="1">
<p class="Usual"><font size="1">Версия 13.0.43:<br>реализовано получение данных из файловых информационных баз 1С 7.7 через простые запросы.</font></p>
<p class="Usual"><font size="1">Версия 12.2.42:<br>исправлена ошибка, из-за которой в запросе к внешней базе 1С 8 колонку нельзя было назвать <i>Количество</i>;<br>на интерфейсе формы команды перехода к web-страница сгруппированы в подменю <i>Поддержка</i>.</font></p>
<p class="Usual"><font size="1">Версия 12.2.41:<br>доработаны пиктограммы активных реляционных операций;<br>добавлена команда скачивания последней версии обработки с сайта автора<font size="1">.</font></font></p>
<p class="Usual"><font size="1">Версия 12.2.40:<br>реализована возможность получения данных из источника типа <i>Таблица</i> номер начиная с конкретной строки, указываемой в реквизите <i>Номер первой строки</i>;<br>исправлена ошибка, из-за которой не контролировалось заполнение некоторых реквизитов для источников типа <i>Таблица</i>.</font></p><font size="1">
<p class="Usual"><font size="1">Версия 12.2.39:<br>пересчет значения относительного периода перенесен в модуль объекта, вызывается при изменении реквизитов формы и в процедуре сравнения данных (перед программным вызовом процедуры </font><i>СравнитьДанныеНаСервере()</i> необходимо либо рассчитать и установить границы периода, либо вызвать процедуру <i>ОбновитьДанныеПериода()</i> для автоматического расчета);<br>перед закрытием выводится запрос на обновление связанного элемента справочника <b>ВС_ОперацииСравненияДанных</b>;<br>в произвольном коде условий вывода строк в таблицу расхождений обращение к имени реквизита теперь производится по имени <i>СтрокаТР.&lt;Имя реквизита&gt;</i>;<br>исправлена ошибка, из-за которой не отрабатывал произвольный код обработки ключа в базах 1С 8.</p></font><font size="1">
<p class="Usual"><font size="1">Версия 12.1.38:<br>реализована возможность указания правой границы относительного периода (например <i>первые 6 месяцев из последних 2 лет</i>, <i>первые 2 дня из последних 3 дней</i>)</font>.</p></font><font size="1">
<p class="Usual"><font size="1">Версия 12.0.37:<br>заголовок устанавливается при открытии из файла, а также при открытии/сохранении в справочник настроек, вручную заголовок не изменяется;<br>справочник хранения настроек <b>НастройкиКонсолиСравненияДанных</b> переименован в <b>ВС_ОперацииСравненияДанных</b> для унификации с конфигурацией <b>Сценарное сравнение данных</b>;<br>реализована возможность заполнения на основании элемента справочника <b>ВС_ОперацииСравненияДанных</b> при открытии (параметр <b>ОперацияСравненияДанных</b>);<br>при сохранении </font><font size="1">вместо </font>открытия формы выбора <font size="1">можно обновить элемент справочника, из которого была заполнена консоль</font>.</p></font><font size="1">
<p class="Usual"><font size="1">Версия 11.4.36:<br>Исправлена ошибка, из-за которой при выгрузке данных на клиенте в случае, когда результат не содержал строк, генерировалось исключение.</font></p>
<p class="Usual"><font size="1">Версия 11.4.35:<br>модальные окна заменены на блокирующие;<br>реализована возможность выгрузки результата сравнения в файл на клиенте.</font></p>
<p class="Usual"><font size="1">Версия 11.3.34:<br>доработан интерфейс.</font></p></font>
<p class="Usual"><font size="1">Версия 11.3.33:<br>исправлена ошибка, из-за которой в некоторых случаях некорректно отрабатывало сравнение по составному ключу из трех столбцов.</font></p>
<p class="Usual"><font size="1">Версия 11.3.32:<br>реализована возможность выгрузки результата сравнения в файл формата CSV (на сервере).</font></p>
<p class="Usual"><font size="1">Версия 11.2.31:<br>добавлены колонки <em>Тип столбца </em>1-3 ключа.</font></p>
<p class="Usual"><font size="1">Версия 11.1.30:<br>реализована возможность установки параметров запроса примитивных типов данных для внешней базы 1С 8.</font></p>
<p class="Usual"><font size="1">Версия 11.0.29:<br>реализована возможность сворачивания данных, полученных из файлов или табличного документа, по ключу (для реквизитов применяется агрегатная функция <em>Сумма</em>).</font></p>
<p class="Usual"><font size="1">Версия 10.0.28:<br>реализована возможность программного изменения столбцов ключа с помощью произвольного кода при чтении данных (обращение к исходным значениям столбцов ключа осуществляется по именам <strong>Ключ1</strong>, <strong>Ключ2</strong>, <strong>Ключ3</strong>, например, может быть задан такой произвольный код: <em>КлючТек = Число(Лев(СокрЛП(КлючТек ), 5))</em>;<br>добавлены кнопки открытия в реквизитах с ключами и произвольным кодом;<br>исправлена ошибка, из-за которой при чтении XML-файла не заполнялся третий столбец составного ключа.</font></p>
<p class="Usual"><font size="1">Версия 9.0.27:<br>реализована возможность использования составного ключа из трех столбцов (используются первые три колонки каждой выборки для баз 1С и SQL и явно указанные номера колонок для файлов).</font></p>
<p class="Usual"><font size="1">Версия 8.2.26:<br>реализована возможность программного изменения реквизитов с помощью произвольного кода при чтении данных из файлов и табличного документа (обращение к значениям реквизитов осуществляется по именам <strong>Р1...Р5</strong>, обращение к текущему - по имени <strong>РТек</strong>, например, для реквизита 3 может быть задан такой произвольный код: <em>РТек = Р1 * Р2 * 1.2).</em></font></p>
<p class="Usual"><font size="1">Версия 8.1.25:<br>реализована возможность открытия формы в пользовательском режиме, где пользователь может только выбирать сохраненные настройки и производить сравнение, для включения режима достаточно установить флаг <strong>Пользовательский режим</strong> в программно созданную обработку либо передать этот флаг как параметр при открытии формы (<em>ОткрытьФорму("Обработка.ВС_КонсольСравненияДанныхИзРазныхИсточников.Форма", Новый Структура("ПользовательскийРежим", Истина), ПараметрыВыполненияКоманды.Источник, Новый УникальныйИдентификатор)).</em></font></p>
<p class="Usual"><font size="1">Версия 8.0.24:<br>исправен запрет на имя колонки выборки запроса: теперь колонку можно называть <em>Количество</em>.</font></p>
<p class="Usual"><font size="1">Версия 8.0.23:<br>исправлена ошибка, из-за которой при наличии пробелов в ключе могли не заполняться реквизиты.</font></p>
<p class="Usual"><font size="1">Версия 8.0.22:<br>реализована возможность сравнения данных из файлов формата XML;<br>исправлена ошибка, из-за которой в некоторых режимах некорректно определялся список  обязательных к заполнению полей;<br>доработан вывод сообщений об ошибках заполнения реквизитов.</font></p>
<p class="Usual"><font size="1">Версия 7.2.21:<br>реализована возможность использования параметров запроса при подключении к текущей базе 1С 8 (параметры <strong>ДатаНачала</strong> и <strong>ДатаОкончания</strong> берутся только с вкладки <strong>Общие настройки -&gt; Основные</strong> даже в том случае, если одноименные есть на вкладке <strong>Параметры запроса</strong>);<br>исправлена ошибка, из-за которой в настройках не сохранялся номер первой строки файла.</font></p>
<p class="Usual"><font size="1">Версия 7.1.20:<br>исправлена ошибка, из-за которой в некоторых случаях некорректно отрабатывало сравнение по составному ключу.</font></p>
<p class="Usual"><font size="1">Версия 7.1.19:<br>увеличена длина и точность типа Число реквизитов.</font></p>
<p class="Usual"><font size="1">Версия 7.0.18:<br>исправлена ошибка, из-за которой невозможно было подключиться к БД SQL Server.</font></p>
<p class="Usual"><font size="1">Версия 7.0.17:<br>реализована возможность сравнения  данных из вручную заполненного табличного документа, расположенного на форме.</font></p>
<p class="Usual"><font size="1">Версия 6.1.16:<br>исправлена ошибка, из-за которой при определенных настройках обработки ключа некорректно формировался ключ. </font></p>
<p class="Usual"><font size="1">Версия 6.1.15:<br>исправлена ошибка, из-за которой невозможно было выве УИД из внешней базы 1С 8.</font></p>
<p class="Usual"><font size="1">Версия 6.0.14:<br>реализована возможность использования составного ключа из двух столбцов (используются первые две колонки каждой выборки для баз 1С и SQL и явно указанные номера колонок для файлов);<br>исправлены ошибки.</font></p>
<p class="Usual"><font size="1">Версия 5.0.13:<br>реализована возможность сравнения данных из файлов формата CSV/TXT/DBF/XLS;<br>при использовании флага Использовать в качестве ключа УИД первая колонка теперь не попадает в реквизит 1, т.е. логика заполнения реквизитов теперь во всех случаях одна: 1-я колонка - ключ, остальные - реквизиты.</font></p>
<p class="Usual"><font size="1">Версия 4.4.12:<br>реализована возможность указания используемого драйвера для подключения к базе данных SQL, также можно выбрать из списка предопределенных (SQL Server, PostgreSQL).</font></p>
<p class="Usual"><font size="1">Версия 4.3.11:<br>добавлены предопределенные параметры ДатаНачала и ДатаОкончания, которые автоматически используются при выполнени запросов к базам 1С;<br>если запрос содержит меньше колонок, чем отображено на форме, лишние колонки автоматически скрываются.</font></p>
<p class="Usual"><font size="1">Версия 4.2.10:<br>во встроенную справку обработки добавлена инструкция по использованию;<br>число колонок выборки из каждой базы увеличено до 5;<br>добавлена возможность быстрым управлением видимостью колонок;<br>исправлены ошибки.</font></p>
<p class="Usual"><font size="1">Версия 4.1.9:<br>реализована возможность сохранения/загрузки настроек в/из справочник/а НастройкиКонсолиСравненияДанных (в справочнике должен быть один реквизит с именем Настройка и типом ХранилищеЗначения);<br>исправлена ошибка при работе с конструктором запроса к внешней базе 1С 8: всегда открывался с пустым запросом.</font></p>
<p class="Usual"><font size="1">Версия 4.0.8:<br>реализована возможность указания условий вывода и запрета вывода строк.</font></p>
<p class="Usual"><font size="1">Версия 3.2.7:<br>реализована подсветка строк, в которых число записей выборки, соответствующих одному ключу, не равно 1;<br>добавлена настройка Приводить ключ к верхнему регистру;<br>добавлена настройка Удалять из ключа фигурные скобки;<br>добавлена настройка Использовать в качестве ключа УИД (автоматически добавляется новая колонка, выполняющая функцию ключа, которая заполняется с помощью вызова функции УникальныйИдентификатор() из ссылочного реквизита первой колонки).</font></p>
<p class="Usual"><font size="1">Версия 3.1.6:<br>убраны требования к числу и именам колонок SQL-запроса.</font></p>
<p class="Usual"><font size="1">Версия 3.1.5:<br>добавлена возможность сохранения/загрузки настроек в/из XML-файл/а.</font></p>
<p class="Usual"><font size="1">Версия 3.0.4:<br>добавлена возможность применения разных реляционных операций к получаемым выборкам.</font></p>
<p class="Usual"><font size="1">Версия 2.1.3:<br>добавлена возможность открытия конструктора запросов к внешним информационным базам 1С 8.</font></p>
<p class="Usual"><font size="1">Версия 2.0.2:<br>добавлена возможность выполнения запросов к базам данных SQL Server.</font></p>
<p class="Usual"><font size="1">Версия 1.0.1:<br>реализована возможноcть выполнения запросов к внешним информационным базам 1С 8;<br>реализованы различные варианты соединения результатов запросов: внутреннее, левое, правое;<br>при формировании текста запроса к текущей базе доступен конструктор запросов.</font></p>
<p class="Usual"><font size="1"></font> </p>
<p><font size="1"><font size="2"><strong>Контактные данные:</strong><br></font>Автор: Сертаков Виталий<br>Электропочта: </font><a href="mailto:sertakov@list.ru"><font size="1">sertakov@list.ru</font></a><br><font size="1">Сайт: </font><font size="1"><a href="http://sertakov.by">http://sertakov.by</a></font><br><font size="1">Скайп: vitaly_sertakov</font></p></font></font></body></html>